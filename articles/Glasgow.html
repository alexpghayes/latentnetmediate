<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="netmediate">
<title>Glasgow • netmediate</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Glasgow">
<meta property="og:description" content="netmediate">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">netmediate</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Unreleased version">0.0.0.9001</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Glasgow.html">Glasgow</a>
    <a class="dropdown-item" href="../articles/interventions.html">Identified interventions under a linear mediated RDPG</a>
    <a class="dropdown-item" href="../articles/reddit.html">reddit</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/alexpghayes/netmediate/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Glasgow</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/alexpghayes/netmediate/blob/HEAD/vignettes/Glasgow.Rmd" class="external-link"><code>vignettes/Glasgow.Rmd</code></a></small>
      <div class="d-none name"><code>Glasgow.Rmd</code></div>
    </div>

    
    
<div class="section level4">
<h4 id="quick-dump-of-details-from-di-maria-paper">Quick dump of details from Di Maria paper<a class="anchor" aria-label="anchor" href="#quick-dump-of-details-from-di-maria-paper"></a>
</h4>
<ul>
<li>cross-sectional analysis for each time point (there are three time
points)</li>
<li>s129 subset</li>
<li>treatment: sex, money</li>
<li>outcome: smoke, cannabis, alcohol (binarized measures)</li>
</ul>
<p>Except for participants’ sex and age, which were recorded at
baseline, other variables were collected at three different time
occasions. Information on substance use (tobacco, alcohol, cannabis),
leisure time activities, music taste, romantic Fig. 2 Steps of the
proposed method: starting from a network (a), a latent space model maps
it into a space of smaller dimension, a plane in (b). The latent
coordinates are then used as mediators (c)</p>
<p>relationships and several others are available. Moreover, social
matrices representing friendship relationships among participants are
included in the dataset. The subsample of subjects selected for the
analysis consists of the 129 students present at all three measurement
times. We conducted a cross-sectional analysis for each time point. Our
interest lies on the way two exposures, Sex, participant’s gender, and
Money, the amount of pocket money each participant had per month, affect
substance use through the relationship network. Sex is a binary
variable, 0 denotes male and 1 female, Money is a continuous variable
ranging from 0 to 40 pounds at the first time, from 0 to 50 pounds at
the second time and from 0 to 70 pounds at the third. As it will be
explained in the next section, we used the variable as it is, when it
plays the role of exposure in the mediation model, and a categorical
version obtained through the quartiles of Money at time 3, when it needs
to be included in the latent space model as covariate. The
categorisation choice is clearly arbitrary, but generates meaningful
categories with acceptable ranges. Figure 3 represents the network at
time 3, where nodes are coloured according to Sex (a) and categories of
Money (b). The social networks representing relationships among students
are defined by non-symmetric matrices, since in the data collection
phase students were asked to name up to six friends. The lists thus
obtained are partially overlapping, but in some cases the relationship
of friendship is not reciprocal. Each cell aij can take three values: 0
if subjects i  j are not friends, 1 if subject i considers j as a friend
and 2 if i considers j as a best friend. We transformed these matrices
into adjacency matrices by merging the last two categories and coding
them with 1, to simply indicate friendship. The three response
variables, Smoke, Cannabis and Alcohol, are measured at each time point
and are categorical. Smoke has three categories: 0 indicates nonsmoker,
1 occasional and 2 regular smoker (i.e. more than once a week). Cannabis
has four levels: 1-never used, 2-tried once, 3 occasional and 4 regular
user. Finally, Fig. 3 Graphical representation of the social network at
time 3 with nodes coloured according to Sex and categories of Money: on
the left panel (a), = male and = female, on the right panel (b) = 1
(0–7£), = 2 (7–12£), = 3 (12–20£), = 4 (20–70£) 123 Networks as
mediating variables: a Bayesian..</p>
<p>Alcohol is a five-category variable coded as follows: 1 non user, 2
once or twice a year, 3 once a month, 4 once a week and 5 more than once
a week. This variable presents some missing values: we excluded subjects
lacking two or three values and, for subjects presenting only a missing,
we imputed it on the basis of the other two collected. This led to the
exclusion of 12 students. We converted all variables into binary ones by
appropriately merging categories: 2 and 3 for Smoke, to distinguish
between smokers (occasional and regular) and non smokers, 1–2 versus 3–4
for Cannabis and 1–2 versus 3–4–5 for Alcohol, respectively, to denote
no or sporadic consumption versus regular consumption. In fact, nothing
would have prevented us from using categorical responses. However, this
would have entailed fitting multinomial models and deriving expressions
for the indirect effect involving more complex derivatives. For the sake
of simplicity, and to make our application easier to understand, we
preferred to convert response variables into binary and to estimate
logistic models.</p>
</div>
<div class="section level4">
<h4 id="quick-data-visualization-time-point-1-only">Quick data visualization (time point 1 only)<a class="anchor" aria-label="anchor" href="#quick-data-visualization-time-point-1-only"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/alexpghayes/netmediate" class="external-link">netmediate</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidygraph.data-imaginist.com" class="external-link">tidygraph</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'tidygraph'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:stats':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     filter</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">glasgow</span>, package <span class="op">=</span> <span class="st">"netmediate"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">glasgow1</span> <span class="op">&lt;-</span> <span class="va">glasgow</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">selection129</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    smokes_dimaria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">tobacco_int</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    drinks_dimaria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">alcohol_int</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    weed_dimaria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">cannabis_int</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">friendship</span> <span class="op">!=</span> <span class="st">"Structurally missing"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span></span>
<span></span>
<span><span class="va">glasgow2</span> <span class="op">&lt;-</span> <span class="va">glasgow</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">selection129</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    smokes_dimaria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">tobacco_int</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    drinks_dimaria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">alcohol_int</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    weed_dimaria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">cannabis_int</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">friendship</span> <span class="op">!=</span> <span class="st">"Structurally missing"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span></span>
<span></span>
<span><span class="va">glasgow3</span> <span class="op">&lt;-</span> <span class="va">glasgow</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">selection129</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    smokes_dimaria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">tobacco_int</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    drinks_dimaria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">alcohol_int</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>    weed_dimaria <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">cannabis_int</span> <span class="op">&gt;</span> <span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">edges</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">friendship</span> <span class="op">!=</span> <span class="st">"Structurally missing"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html" class="external-link">activate</a></span><span class="op">(</span><span class="va">nodes</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">glasgow1</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tbl_graph: 129 nodes and 449 edges</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; #</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; # A directed multigraph with 4 components</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; #</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; # Node Data: 129 × 50 (active)</span></span></span>
<span><span class="co">#&gt;   name    age select… select… sex_fct smokin… parent… siblin… alcoho… tobacc…</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> s001   13.3 TRUE    TRUE    female  no      no      no            3       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> s002   13.3 TRUE    FALSE   male    no      no      no           <span style="color: #BB0000;">NA</span>       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> s003   13.7 TRUE    TRUE    female  yes     yes     no            2       3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> s004   12.9 TRUE    FALSE   male    no      no      no            2       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> s005   13.6 TRUE    FALSE   male    no      no      no            2       1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> s006   13.8 TRUE    FALSE   male    yes     no      yes           3       3</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 123 more rows, and 40 more variables: cannabis_int &lt;int&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   alcohol_fct &lt;ord&gt;, tobacco_fct &lt;fct&gt;, cannabis_fct &lt;fct&gt;, money &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   romantic &lt;fct&gt;, leisure_music_at_home &lt;chr&gt;, leisure_shopping &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   leisure_reading &lt;chr&gt;, leisure_watch_sports &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   leisure_play_sports &lt;chr&gt;, leisure_hang_streets &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   leisure_videogames &lt;chr&gt;, leisure_hobby &lt;chr&gt;, leisure_organized &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   leisure_movies &lt;chr&gt;, leisure_concerts &lt;chr&gt;, leisure_church &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   leisure_pet &lt;chr&gt;, leisure_dancing &lt;chr&gt;, leisure_be_bored &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   music_rock &lt;chr&gt;, music_chart &lt;chr&gt;, music_reggae &lt;chr&gt;, music_dance &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   music_heavy &lt;chr&gt;, music_techno &lt;chr&gt;, music_folk &lt;chr&gt;, music_rave &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   music_indie &lt;chr&gt;, music_jazz &lt;chr&gt;, music_classical &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   music_sixty &lt;chr&gt;, music_house &lt;chr&gt;, music_grunge &lt;chr&gt;, music_rap &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   music_hiphop &lt;chr&gt;, smokes_dimaria &lt;dbl&gt;, drinks_dimaria &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   weed_dimaria &lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#</span></span></span>
<span><span class="co"><span style="color: #949494;">#&gt; # Edge Data: 449 × 3</span></span></span>
<span><span class="co">#&gt;    from    to friendship </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1    23 Friend     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>     1    26 Best friend</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>     2    30 Friend     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 446 more rows</span></span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggraph.data-imaginist.com" class="external-link">ggraph</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: ggplot2</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">27</span><span class="op">)</span></span>
<span></span>
<span><span class="va">layout</span> <span class="op">&lt;-</span> <span class="va">glasgow1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    in_degree <span class="op">=</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/centrality.html" class="external-link">centrality_degree</a></span><span class="op">(</span>mode <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">create_layout</a></span><span class="op">(</span>layout <span class="op">=</span> <span class="st">'stress'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">layout</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_fan.html" class="external-link">geom_edge_fan</a></span><span class="op">(</span></span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">'mm'</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    end_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html" class="external-link">circle</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="st">'mm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html" class="external-link">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="va">in_degree</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Friendships in a secondary school in Glasgow"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"s129 dataset from the Teenage Friends and Lifestyle Study, 1995"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Each node represents one student"</span>,</span>
<span>    size <span class="op">=</span> <span class="st">"Popularity (in-degree)"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/theme_graph.html" class="external-link">theme_graph</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: Using the `size` aesthetic in this geom was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` in the `default_aes` field and elsewhere instead.</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">layout</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_fan.html" class="external-link">geom_edge_fan</a></span><span class="op">(</span></span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">'mm'</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    end_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html" class="external-link">circle</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="st">'mm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html" class="external-link">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">money</span>, size <span class="op">=</span> <span class="va">in_degree</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Spending money in a secondary school in Glasgow"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"s129 dataset from the Teenage Friends and Lifestyle Study, 1995"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Each node represents one student"</span>,</span>
<span>    size <span class="op">=</span> <span class="st">"Popularity (in-degree)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Weekly spending money"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/theme_graph.html" class="external-link">theme_graph</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">layout</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html" class="external-link">ggraph</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_fan.html" class="external-link">geom_edge_fan</a></span><span class="op">(</span></span>
<span>    arrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/arrow.html" class="external-link">arrow</a></span><span class="op">(</span>length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">1</span>, <span class="st">'mm'</span><span class="op">)</span><span class="op">)</span>, </span>
<span>    end_cap <span class="op">=</span> <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geometry.html" class="external-link">circle</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="st">'mm'</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html" class="external-link">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>color <span class="op">=</span> <span class="va">tobacco_fct</span>, size <span class="op">=</span> <span class="va">in_degree</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Tobacco use in a secondary school in Glasgow"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"s129 dataset from the Teenage Friends and Lifestyle Study, 1995"</span>,</span>
<span>    caption <span class="op">=</span> <span class="st">"Each node represents one student"</span>,</span>
<span>    size <span class="op">=</span> <span class="st">"Popularity (in-degree)"</span>,</span>
<span>    color <span class="op">=</span> <span class="st">"Tobacco usage"</span></span>
<span>  <span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/theme_graph.html" class="external-link">theme_graph</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="embeddings-and-some-diagnostics">Embeddings and some diagnostics<a class="anchor" aria-label="anchor" href="#embeddings-and-some-diagnostics"></a>
</h4>
<p>Looks like 4-5 latent dimensions are sufficient per Karl’s
diagnostic, perhaps all the way to 10</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RoheLab/gdim" class="external-link">gdim</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span></span>
<span><span class="va">A1</span> <span class="op">&lt;-</span> <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as_adjacency_matrix.html" class="external-link">as_adj</a></span><span class="op">(</span><span class="va">glasgow1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">cv_eigs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/gdim/man/eigcv.html" class="external-link">eigcv</a></span><span class="op">(</span><span class="va">A1</span>, k_max <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="va">cv_eigs</span></span>
<span><span class="co">#&gt; Estimated graph dimension:    0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of bootstraps:         10</span></span>
<span><span class="co">#&gt; Edge splitting probabaility:  0.1</span></span>
<span><span class="co">#&gt; Significance level:       0.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  ------------ Summary of Tests ------------</span></span>
<span><span class="co">#&gt;   k           z       pvals        padj</span></span>
<span><span class="co">#&gt;   1  1.61135981 0.053550661 0.053550661</span></span>
<span><span class="co">#&gt;   2  2.39981568 0.008201665 0.008201665</span></span>
<span><span class="co">#&gt;   3  1.70615708 0.043989418 0.043989418</span></span>
<span><span class="co">#&gt;   4  0.91198386 0.180888606 0.180888606</span></span>
<span><span class="co">#&gt;   5  1.66321115 0.048135088 0.048135088</span></span>
<span><span class="co">#&gt;   6  1.50960612 0.065571979 0.065571979</span></span>
<span><span class="co">#&gt;   7  0.67515874 0.249787457 0.249787457</span></span>
<span><span class="co">#&gt;   8  1.17736036 0.119525852 0.119525852</span></span>
<span><span class="co">#&gt;   9  1.44636314 0.074037687 0.074037687</span></span>
<span><span class="co">#&gt;  10  0.45000384 0.326353835 0.326353835</span></span>
<span><span class="co">#&gt;  11 -0.02632028 0.510499062 0.510499062</span></span>
<span><span class="co">#&gt;  12  0.00571659 0.497719423 0.497719423</span></span>
<span><span class="co">#&gt;  13  0.31424832 0.376666223 0.376666223</span></span>
<span><span class="co">#&gt;  14 -0.08212542 0.532726509 0.532726509</span></span>
<span><span class="co">#&gt;  15 -0.25413369 0.600303860 0.600303860</span></span>
<span><span class="co">#&gt;  16 -0.64060377 0.739109925 0.739109925</span></span>
<span><span class="co">#&gt;  17  0.06003967 0.476062020 0.476062020</span></span>
<span><span class="co">#&gt;  18 -0.39549319 0.653760526 0.653760526</span></span>
<span><span class="co">#&gt;  19 -0.18141921 0.571980730 0.571980730</span></span>
<span><span class="co">#&gt;  20 -0.32151324 0.626089260 0.626089260</span></span>
<span><span class="co">#&gt;  21 -0.63500251 0.737286610 0.737286610</span></span>
<span><span class="co">#&gt;  22 -0.97866639 0.836127579 0.836127579</span></span>
<span><span class="co">#&gt;  23 -0.78138905 0.782713144 0.782713144</span></span>
<span><span class="co">#&gt;  24 -1.05247120 0.853708291 0.853708291</span></span>
<span><span class="co">#&gt;  25 -0.87448609 0.809073205 0.809073205</span></span>
<span><span class="co">#&gt;  26 -0.80266735 0.788916487 0.788916487</span></span>
<span><span class="co">#&gt;  27 -1.23385029 0.891370652 0.891370652</span></span>
<span><span class="co">#&gt;  28 -1.22613565 0.889926184 0.889926184</span></span>
<span><span class="co">#&gt;  29 -0.97238655 0.834570861 0.834570861</span></span>
<span><span class="co">#&gt;  30 -1.15947131 0.876867938 0.876867938</span></span>
<span><span class="co">#&gt;  31 -1.19830958 0.884601741 0.884601741</span></span>
<span><span class="co">#&gt;  32 -1.15439618 0.875831109 0.875831109</span></span>
<span><span class="co">#&gt;  33 -0.95884745 0.831182200 0.831182200</span></span>
<span><span class="co">#&gt;  34 -1.03707194 0.850148835 0.850148835</span></span>
<span><span class="co">#&gt;  35 -0.79591493 0.786959259 0.786959259</span></span>
<span><span class="co">#&gt;  36 -0.67077626 0.748818463 0.748818463</span></span>
<span><span class="co">#&gt;  37 -1.16312193 0.877609983 0.877609983</span></span>
<span><span class="co">#&gt;  38 -0.42087875 0.663078189 0.663078189</span></span>
<span><span class="co">#&gt;  39 -0.63474385 0.737202256 0.737202256</span></span>
<span><span class="co">#&gt;  40 -0.62677948 0.734598101 0.734598101</span></span>
<span><span class="co">#&gt;  41 -0.39539876 0.653725690 0.653725690</span></span>
<span><span class="co">#&gt;  42 -0.71953871 0.764095469 0.764095469</span></span>
<span><span class="co">#&gt;  43 -0.71576383 0.762931404 0.762931404</span></span>
<span><span class="co">#&gt;  44 -0.42584870 0.664890950 0.664890950</span></span>
<span><span class="co">#&gt;  45 -0.67151549 0.749053902 0.749053902</span></span>
<span><span class="co">#&gt;  46 -0.42327195 0.663951573 0.663951573</span></span>
<span><span class="co">#&gt;  47 -0.22170766 0.587729265 0.587729265</span></span>
<span><span class="co">#&gt;  48 -0.38215153 0.648825514 0.648825514</span></span>
<span><span class="co">#&gt;  49 -0.61514782 0.730771449 0.730771449</span></span>
<span><span class="co">#&gt;  50 -0.66429326 0.746748682 0.746748682</span></span></code></pre></div>
<p>Now we look at varimax embeddings to sanity check them</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RoheLab/vsp" class="external-link">vsp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fa1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/vsp/man/vsp.html" class="external-link">vsp</a></span><span class="op">(</span><span class="va">A1</span>, rank <span class="op">=</span> <span class="fl">9</span>, degree_normalize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="va">fa1</span></span>
<span><span class="co">#&gt; Vintage Sparse PCA Factor Analysis</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Rows (n):   129</span></span>
<span><span class="co">#&gt; Cols (d):   129</span></span>
<span><span class="co">#&gt; Factors (rank): 9</span></span>
<span><span class="co">#&gt; Lambda[rank]:   3.5596</span></span>
<span><span class="co">#&gt; Components</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Z: 129 x 9 [dgeMatrix] </span></span>
<span><span class="co">#&gt; B: 9 x 9 [dgeMatrix] </span></span>
<span><span class="co">#&gt; Y: 129 x 9 [dgeMatrix] </span></span>
<span><span class="co">#&gt; u: 129 x 9 [matrix] </span></span>
<span><span class="co">#&gt; d: 9      [numeric] </span></span>
<span><span class="co">#&gt; v: 129 x 9 [matrix]</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/vsp/man/plot_mixing_matrix.html" class="external-link">plot_mixing_matrix</a></span><span class="op">(</span><span class="va">fa1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/screeplot.html" class="external-link">screeplot</a></span><span class="op">(</span><span class="va">fa1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-7-2.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/vsp/man/plot_ipr_pairs.html" class="external-link">plot_ipr_pairs</a></span><span class="op">(</span><span class="va">fa1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>The varimax factors look decently clear in the plots below</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RoheLab/vsp" class="external-link">vsp</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fa1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vsp/man/get_svd_u.html" class="external-link">get_varimax_y</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html" class="external-link">ggpairs</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span></span>
<span><span class="co">#&gt;   method from   </span></span>
<span><span class="co">#&gt;   +.gg   ggplot2</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fa1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/vsp/man/get_svd_u.html" class="external-link">get_varimax_z</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">9</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>leverage <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/pmap.html" class="external-link">pmap_dbl</a></span><span class="op">(</span><span class="va">.</span>, <span class="va">sum</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">leverage</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">GGally</span><span class="fu">::</span><span class="fu"><a href="https://ggobi.github.io/ggally/reference/ggpairs.html" class="external-link">ggpairs</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span>, progress <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="causal-estimates">Causal estimates<a class="anchor" aria-label="anchor" href="#causal-estimates"></a>
</h4>
<p>First we use the left embedding (<span class="math inline">\(US^{1/2}\)</span>) and get</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">u_curve</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensitivity_curve.html">sensitivity_curve</a></span><span class="op">(</span><span class="va">glasgow1</span>, <span class="va">smokes_dimaria</span> <span class="op">~</span> <span class="va">sex_fct</span>, max_rank <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">u_curve</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Estimated effects of sex on smoking as function of latent dimension at time 1"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"using U sqrt(S) as embedding"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>Then we use the right embedding (<span class="math inline">\(V
S^{1/2}\)</span>, personally these factors seem most compelling to me)
and get</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v_curve</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensitivity_curve.html">sensitivity_curve</a></span><span class="op">(</span><span class="va">glasgow1</span>, <span class="va">smokes_dimaria</span> <span class="op">~</span> <span class="va">sex_fct</span>, max_rank <span class="op">=</span> <span class="fl">15</span>, coembedding <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">v_curve</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Estimated effects of sex on smoking as function of latent dimension at time 1"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"using V sqrt(S) as embedding"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<p>The TL;DR is basically that all reasonable confidence intervals for
the direct and indirect effects include zero. This makes sense, since
the ATE is barely inconsistent with a null effect itself.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glasgow1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">smokes_dimaria</span> <span class="op">~</span> <span class="va">sex_fct</span>, data <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;                  2.5 %      97.5 %</span></span>
<span><span class="co">#&gt; (Intercept)  0.1561221  0.34387787</span></span>
<span><span class="co">#&gt; sex_fctmale -0.2926031 -0.04301337</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="estimates-using-symmetrized-network">Estimates using symmetrized network<a class="anchor" aria-label="anchor" href="#estimates-using-symmetrized-network"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glasgow1_sym</span> <span class="op">&lt;-</span> <span class="va">glasgow1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu">igraph</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/igraph/man/as.directed.html" class="external-link">as.undirected</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/tbl_graph.html" class="external-link">as_tbl_graph</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">v_curve_sym</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensitivity_curve.html">sensitivity_curve</a></span><span class="op">(</span></span>
<span>  <span class="va">glasgow1_sym</span>,</span>
<span>  <span class="va">smokes_dimaria</span> <span class="op">~</span> <span class="va">sex_fct</span>,</span>
<span>  max_rank <span class="op">=</span> <span class="fl">15</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">v_curve_sym</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Estimated effects of sex on smoking as function of latent dimension at time 1"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Using embeddings from symmetrized adjacency matrix"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="estimates-using-regularized-directed-graph-laplacian">Estimates using regularized (directed) graph Laplacian<a class="anchor" aria-label="anchor" href="#estimates-using-regularized-directed-graph-laplacian"></a>
</h2>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rohelab.github.io/invertiforms/" class="external-link">invertiforms</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'invertiforms'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     transform</span></span>
<span></span>
<span><span class="va">iform</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rohelab.github.io/invertiforms/reference/RegularizedLaplacian.html" class="external-link">RegularizedLaplacian</a></span><span class="op">(</span><span class="va">A1</span><span class="op">)</span></span>
<span><span class="va">L_okc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rohelab.github.io/invertiforms/reference/transform.html" class="external-link">transform</a></span><span class="op">(</span><span class="va">iform</span>, <span class="va">A1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">max_rank</span> <span class="op">&lt;-</span> <span class="fl">15</span></span>
<span></span>
<span><span class="va">s_max</span> <span class="op">&lt;-</span> <span class="fu">RSpectra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RSpectra/man/svds.html" class="external-link">svds</a></span><span class="op">(</span><span class="va">L_okc</span>, <span class="va">max_rank</span>, <span class="va">max_rank</span><span class="op">)</span></span>
<span><span class="va">X_max</span> <span class="op">&lt;-</span> <span class="va">s_max</span><span class="op">$</span><span class="va">v</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">s_max</span><span class="op">$</span><span class="va">d</span><span class="op">)</span><span class="op">)</span>  <span class="co"># use right embeddings here</span></span>
<span></span>
<span><span class="co"># and now we plug them into the product-of-coefs estimator</span></span>
<span></span>
<span><span class="va">curve_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/sensitivity_curve_custom.html">sensitivity_curve_custom</a></span><span class="op">(</span></span>
<span>  <span class="va">glasgow1_sym</span>,</span>
<span>  <span class="va">smokes_dimaria</span> <span class="op">~</span> <span class="va">sex_fct</span>,</span>
<span>  <span class="va">X_max</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">curve_custom</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Estimated effects of sex on smoking as function of latent dimension at time 1"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"Using embeddings from regularized graph Laplacian"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="section level3">
<h3 id="other-analyses">Other analyses<a class="anchor" aria-label="anchor" href="#other-analyses"></a>
</h3>
<div class="section level4">
<h4 id="sex-on-smoking-at-time-2">Sex on smoking at time 2<a class="anchor" aria-label="anchor" href="#sex-on-smoking-at-time-2"></a>
</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glasgow2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sensitivity_curve.html">sensitivity_curve</a></span><span class="op">(</span><span class="va">smokes_dimaria</span> <span class="op">~</span> <span class="va">sex_fct</span>, max_rank <span class="op">=</span> <span class="fl">15</span>, coembedding <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Estimated effects of sex on smoking as function of latent dimension at time 2"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"using V sqrt(S) as embedding"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-16-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="sex-on-smoking-at-time-3">Sex on smoking at time 3<a class="anchor" aria-label="anchor" href="#sex-on-smoking-at-time-3"></a>
</h4>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glasgow3</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sensitivity_curve.html">sensitivity_curve</a></span><span class="op">(</span><span class="va">smokes_dimaria</span> <span class="op">~</span> <span class="va">sex_fct</span>, max_rank <span class="op">=</span> <span class="fl">15</span>, coembedding <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Estimated effects of sex on smoking as function of latent dimension at time 3"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"using V sqrt(S) as embedding"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="wealth-on-smoking-at-time-1">Wealth on smoking at time 1<a class="anchor" aria-label="anchor" href="#wealth-on-smoking-at-time-1"></a>
</h4>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glasgow1</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sensitivity_curve.html">sensitivity_curve</a></span><span class="op">(</span><span class="va">smokes_dimaria</span> <span class="op">~</span> <span class="va">money</span>, max_rank <span class="op">=</span> <span class="fl">15</span>, coembedding <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Estimated effects of spending money on smoking as function of latent dimension at time 1"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"using V sqrt(S) as embedding"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="wealth-on-smoking-at-time-2">Wealth on smoking at time 2<a class="anchor" aria-label="anchor" href="#wealth-on-smoking-at-time-2"></a>
</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glasgow2</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sensitivity_curve.html">sensitivity_curve</a></span><span class="op">(</span><span class="va">smokes_dimaria</span> <span class="op">~</span> <span class="va">money</span>, max_rank <span class="op">=</span> <span class="fl">15</span>, coembedding <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Estimated effects of spending money on smoking as function of latent dimension at time 2"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"using V sqrt(S) as embedding"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-19-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="wealth-on-smoking-at-time-3">Wealth on smoking at time 3<a class="anchor" aria-label="anchor" href="#wealth-on-smoking-at-time-3"></a>
</h4>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glasgow3</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/sensitivity_curve.html">sensitivity_curve</a></span><span class="op">(</span><span class="va">smokes_dimaria</span> <span class="op">~</span> <span class="va">money</span>, max_rank <span class="op">=</span> <span class="fl">15</span>, coembedding <span class="op">=</span> <span class="st">"V"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>, linetype <span class="op">=</span> <span class="st">"dashed"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span>
<span>    title <span class="op">=</span> <span class="st">"Estimated effects of spending money on smoking as function of latent dimension at time 3"</span>,</span>
<span>    subtitle <span class="op">=</span> <span class="st">"using V sqrt(S) as embedding"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<p><img src="Glasgow_files/figure-html/unnamed-chunk-20-1.png" width="700"></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://alexpghayes.com" class="external-link">Alex Hayes</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
